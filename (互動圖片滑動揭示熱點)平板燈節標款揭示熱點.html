<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>產品構造透視互動展示 (修復版)</title>
<style>
  /* [修正] 全域盒模型 */
  * { box-sizing: border-box; }

  /* [SOP] 歸零與基礎設定 */
  html, body {
    margin: 0; padding: 0;
    width: 100%; height: 100%;
    overflow: hidden; 
    background-color: transparent; 
    font-family: "Microsoft JhengHei", "Heiti TC", sans-serif;
  }

  /* === 共用變數 === */
  :root {
    --handle-color: #ffffff;
    --handle-line: #333333;
    --dot-core: rgba(0, 0, 0, 0.85);
    --dot-halo: rgba(255, 255, 255, 0.6);
    --glass-bg: rgba(255, 255, 255, 0.35);
    --glass-border: rgba(255, 255, 255, 0.5);
    --glass-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.2);
  }

  /* 通用熱點樣式 */
  .dot {
    position: absolute;
    width: 16px; height: 16px;
    background-color: var(--dot-core);
    border-radius: 50%;
    box-shadow: 0 0 0 4px var(--dot-halo);
    animation: pulse 2s infinite;
    z-index: 20;
    top: 50%; left: 50%; 
    transform: translate(-50%, -50%);
  }
  @keyframes pulse {
    0% { transform: translate(-50%, -50%) scale(0.95); box-shadow: 0 0 0 0 rgba(0,0,0,0.7); }
    70% { transform: translate(-50%, -50%) scale(1); box-shadow: 0 0 0 10px rgba(0,0,0,0); }
    100% { transform: translate(-50%, -50%) scale(0.95); box-shadow: 0 0 0 0 rgba(0,0,0,0); }
  }
  
  .label-glass {
    background: var(--glass-bg);
    -webkit-backdrop-filter: blur(10px); backdrop-filter: blur(10px);
    border: 1px solid var(--glass-border);
    box-shadow: var(--glass-shadow);
    color: #000; font-weight: 700;
    border-radius: 12px; padding: 10px 14px;
    font-size: 14px; line-height: 1.5;
    text-shadow: 0 1px 2px rgba(255,255,255,0.8);
  }

  /* =========================================
     桌機版樣式 (Desktop Styles) 
     ========================================= */
  .desktop-view {
    display: none; position: relative;
    width: 100%; height: 100%;
    overflow: hidden; user-select: none; cursor: col-resize;
  }

  @media (min-width: 769px) {
    .desktop-view { display: block; }
    .mobile-view { display: none !important; }
  }

  .desktop-view img {
    position: absolute; top: 0; left: 0;
    width: 100%; height: 100%;
    object-fit: cover; pointer-events: none;
  }
  .layer-right { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; }
  .layer-left {
    position: absolute; top: 0; left: 0; width: 50%; height: 100%;
    overflow: hidden; z-index: 10;
    border-right: 3px solid var(--handle-color); background-color: #fff;
  }
  .layer-left img { width: 100vw; max-width: none; }
  
  /* [修正] 把手樣式：現在它是獨立的，不受 overflow 影響 */
  .handle {
    position: absolute; 
    top: 50%; 
    left: 50%; /* JS 會動態控制這個數值 */
    width: 40px; height: 40px;
    background: var(--handle-color); border-radius: 50%; 
    z-index: 25; /* 確保在最上層 */
    transform: translate(-50%, -50%); /* 確保中心對齊分隔線 */
    display: flex; justify-content: center; align-items: center;
    box-shadow: 0 2px 10px rgba(0,0,0,0.3);
    pointer-events: none; /* 讓滑鼠事件穿透到容器 */
  }
  .handle span { color: var(--handle-line); font-weight: bold; letter-spacing: -2px; }

  .hotspot-pc { position: absolute; z-index: 15; display: flex; align-items: center; white-space: nowrap; }
  .hotspot-pc .dot { position: relative; top: auto; left: auto; transform: none; flex-shrink: 0; }
  .hotspot-pc .label {
    position: absolute; left: 30px; top: 50%; transform: translateY(-50%);
    width: max-content; max-width: 280px; white-space: normal;
    opacity: 0; animation: fadeIn 0.5s ease-out 0.5s forwards;
  }
  .hotspot-pc.pos-left .label { left: auto; right: 30px; }
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(-50%) translateX(-5px); }
    to { opacity: 1; transform: translateY(-50%) translateX(0); }
  }
  .caption-area {
    position: absolute; bottom: 20px; width: 100%;
    display: flex; justify-content: space-between; padding: 0 30px;
    pointer-events: none; z-index: 30;
  }
  .caption { background: rgba(0,0,0,0.6); color: white; padding: 6px 12px; border-radius: 4px; font-size: 14px; }


  /* =========================================
     手機版樣式 (Mobile Styles)
     ========================================= */
  .mobile-view {
    display: none; width: 100%;
    padding: 5px 5px; 
  }

  @media (max-width: 768px) {
    .mobile-view { display: flex; flex-direction: column; gap: 15px; }
    .desktop-view { display: none !important; }
    html, body { overflow-y: auto; height: auto; }
  }

  .product-section {
    position: relative; width: 100%;
    overflow: visible; 
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    border-radius: 8px;
  }

  .section-title {
    position: absolute; top: 0; left: 0; width: 100%; z-index: 5;
    text-align: center; padding: 12px 0;
    background: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(4px); -webkit-backdrop-filter: blur(4px);
    color: #fff; font-weight: bold; font-size: 1.1rem; letter-spacing: 1px;
    border-radius: 8px 8px 0 0; 
  }

  .image-container { position: relative; width: 100%; line-height: 0; }
  
  .image-container img { 
    width: 100%; 
    display: block;
    min-height: 480px; 
    object-fit: cover;
    object-position: center;
    border-radius: 8px; 
  }

  .hotspot-m { position: absolute; width: 0; height: 0; z-index: 10; }
  .hotspot-m .label {
    position: absolute; top: 50%; transform: translateY(-50%);
    width: max-content; max-width: 140px; 
    z-index: 15; font-size: 13px; font-weight: 600;
  }
  
  .hotspot-m.layout-right .label { left: 24px; }
  .hotspot-m.layout-right .label::before {
    content: ''; position: absolute; top: 50%; left: -6px; transform: translateY(-50%);
    border-width: 6px 6px 6px 0; border-style: solid; border-color: transparent var(--glass-border) transparent transparent;
  }
  
  .hotspot-m.layout-left .label { right: 24px; left: auto; }
  .hotspot-m.layout-left .label::before {
    content: ''; position: absolute; top: 50%; right: -6px; transform: translateY(-50%);
    border-width: 6px 0 6px 6px; border-style: solid; border-color: transparent transparent transparent var(--glass-border);
  }

</style>
</head>
<body>

  <div class="desktop-view" id="sliderContainer">
    <div class="layer-right">
      <img src="https://system49.webtech.com.tw/web/202200228/archive/image/TSts/555/555-2.jpg?v=2drgw87" alt="燈板背面">
      <div class="hotspot-pc pos-left" style="top: 35%; left: 55%;">
        <div class="dot"></div>
        <div class="label label-glass">二級迴路LED驅動器，PFC主動功因，漣波&lt;3%幾乎無頻閃，驅動器效率高達91%，無頻閃、低光衰，照明更舒適。</div>
      </div>
      <div class="hotspot-pc pos-left" style="top: 80%; left: 55%;">
        <div class="dot"></div>
        <div class="label label-glass">全金屬散熱背板，有效降低熱堆積，將耐用度提升至工業級標準，光源壽命可超越十年。</div>
      </div>
    </div>
    
    <div class="layer-left" id="overlayLayer">
      <!-- [修正] 這裡的 ID 改回 overlayImage 與 JS 一致 -->
      <img src="https://system49.webtech.com.tw/web/202200228/archive/image/TSts/555/555-1.jpg?v=ww0tee" id="overlayImage" alt="燈罩內部">
      
      <div class="hotspot-pc" style="top: 45%; left: 38%;">
        <div class="dot"></div>
        <div class="label label-glass">高規格LED晶粒搭配高階透鏡光學，專業直下式設計解決傳統側發光導光板容易老化泛黃的通病。</div>
      </div>
      <div class="hotspot-pc" style="top: 75%; left: 35%;">
        <div class="dot"></div>
        <div class="label label-glass">高反射率<br>內層塗料</div>
      </div>
    </div>
    
    <!-- [修正] 把 handle 移出來，變成 sliderContainer 的直接子元素，避免被 layer-left 的 overflow 裁切 -->
    <div class="handle" id="sliderHandle"><span>&#10094; &#10095;</span></div>

    <div class="caption-area">
      <div class="caption">◀ 燈罩內部構造</div>
      <div class="caption">燈板背部細節 ▶</div>
    </div>
  </div>

  <div class="mobile-view">
    <div class="product-section">
      <div class="section-title">燈罩內部構造</div>
      <div class="image-container">
        <img src="https://system49.webtech.com.tw/web/202200228/archive/image/TSts/555/555-1.jpg?v=ww0tee" alt="燈罩內部">
        <div class="hotspot-m layout-right" style="top: 40%; left: 15%;">
          <div class="dot"></div>
          <div class="label label-glass"><strong>高透光學透鏡</strong><br>高規格LED晶粒搭配直下式設計，精準導光。</div>
        </div>
        <div class="hotspot-m layout-right" style="top: 80%; left: 35%;">
          <div class="dot"></div>
          <div class="label label-glass"><strong>高反射率塗層</strong><br>特殊內層塗料，最大化亮度輸出。</div>
        </div>
      </div>
    </div>

    <div class="product-section">
      <div class="section-title">燈板背部細節</div>
      <div class="image-container">
        <img src="https://system49.webtech.com.tw/web/202200228/archive/image/TSts/555/555-2.jpg?v=2drgw87" alt="燈板背面">
        <div class="hotspot-m layout-left" style="top: 50%; left: 60%;">
          <div class="dot"></div>
          <div class="label label-glass"><strong>二級迴路驅動器</strong><br>PFC主動功因，無頻閃低光衰。</div>
        </div>
        <div class="hotspot-m layout-left" style="top: 80%; left: 65%;">
          <div class="dot"></div>
          <div class="label label-glass"><strong>全金屬散熱背板</strong><br>耐用度達工業級，光源壽命超越十年。</div>
        </div>
      </div>
    </div>
  </div>

<script>
  // 桌機版滑動邏輯
  const container = document.getElementById('sliderContainer');
  const overlayLayer = document.getElementById('overlayLayer');
  const overlayImage = document.getElementById('overlayImage');
  const sliderHandle = document.getElementById('sliderHandle'); // [修正] 抓取新的把手元素

  function initImageSize() {
    if(container.offsetParent !== null && overlayImage) { 
        const width = container.offsetWidth;
        overlayImage.style.width = width + 'px';
    }
  }

  window.addEventListener('resize', initImageSize);
  // [修正] 增加保護，確保圖片存在才綁定 onload
  if (overlayImage) {
      overlayImage.onload = initImageSize;
  }
  setInterval(initImageSize, 500);

  function updateSlider(clientX) {
    const rect = container.getBoundingClientRect();
    let x = clientX - rect.left;
    if (x < 0) x = 0;
    if (x > rect.width) x = rect.width;
    
    const percentage = (x / rect.width) * 100;
    
    // [修正] 同時更新 遮罩寬度 與 把手位置
    overlayLayer.style.width = percentage + '%';
    sliderHandle.style.left = percentage + '%'; 
  }

  container.addEventListener('mousemove', (e) => {
    if (window.innerWidth > 768) {
       updateSlider(e.clientX);
    }
  });
  
  container.addEventListener('click', (e) => {
    if (window.innerWidth > 768) {
       updateSlider(e.clientX);
    }
  });

  initImageSize();
</script>

</body>
</html>