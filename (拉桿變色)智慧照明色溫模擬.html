<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>智慧照明色溫模擬</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet" />
    <style>
        /* 1. 基礎設定：透明背景 */
        body { 
            font-family: 'Noto Sans TC', sans-serif; 
            background-color: transparent; /* ★ 關鍵：透明背景 */
            margin: 0;
            padding: 0;
            overflow: hidden; /* 防止捲軸 */
        }

        /* 2. 圖片容器：移除原本的白色卡片樣式，只保留圖片 */
        .simulator-wrapper {
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .img-box {
            position: relative;
            width: 90%;
            /* 讓圖片盡量大，但留空間給下方拉桿 */
            height: calc(100% - 80px); 
            border-radius: 8px;
            overflow: hidden;
            /* 輕微陰影提升質感 */
            box-shadow: 0 4px 20px rgba(0,0,0,0.1); 
        }

        /* 3. 自定義滑桿樣式 (美化版) */
        input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            height: 10px;
            border-radius: 9999px;
            /* 漂亮的漸層色條 */
            background: linear-gradient(to right, #FFD6AA 0%, #FFFFFF 50%, #C8E2FF 100%);
            outline: none;
            cursor: pointer;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }

        /* 滑塊 (Thumb) - Webkit */
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: #fff;
            border: 4px solid #555; /* 加粗邊框更有質感 */
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            cursor: pointer;
            transition: transform 0.1s;
            margin-top: -1px; 
        }
        input[type=range]::-webkit-slider-thumb:hover { transform: scale(1.1); }

        /* 滑塊 (Thumb) - Firefox */
        input[type=range]::-moz-range-thumb {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: #fff;
            border: 4px solid #555;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            cursor: pointer;
        }

        /* 4. 混合模式層 (保留您的設定) */
        .overlay-layer {
            position: absolute;
            inset: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            mix-blend-mode: overlay; /* ★ 依照您的設定 */
            transition: background-color 0.1s ease;
            z-index: 10;
        }

        /* 5. 數值顯示與標籤 */
        .k-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(4px);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-family: monospace;
            font-size: 16px;
            z-index: 20;
            border: 1px solid rgba(255,255,255,0.3);
        }

        .controls-area {
            width: 100%;
            padding: 10px 5px 0 5px;
            box-sizing: border-box;
        }

        .labels {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .label-item { cursor: pointer; transition: color 0.2s; text-align: center; }
        .label-item:hover { color: #000; }
        .sub-text { font-size: 12px; font-weight: normal; color: #888; display: block; }

    </style>
</head>
<body>

    <div class="simulator-wrapper">
        
        <div class="img-box group">
            
            <img id="main-image" src="https://system49.webtech.com.tw/web/202200228/archive/image/TSts/555_lv1/gw555_bg3.jpg?v=wbfoe4a" alt="辦公室環境圖" class="w-full h-full object-cover transition-all duration-100">

            <div id="light-overlay" class="overlay-layer"></div>
            <div id="light-overlay-cool" class="overlay-layer"></div>

            <div class="k-badge">
                <span id="current-k-display">5000K</span>
            </div>
        </div>

        <div class="controls-area">
            <div class="labels">
                <div class="label-item text-left" onclick="setTemp(4000)">
                    4000K<span class="sub-text">暖白光</span>
                </div>
                <div class="label-item" onclick="setTemp(5000)">
                    5000K<span class="sub-text">自然光</span>
                </div>
                <div class="label-item text-right" onclick="setTemp(5700)">
                    5700K<span class="sub-text">冷白光</span>
                </div>
            </div>

            <div class="relative w-full flex items-center">
                <input type="range" id="temp-slider" min="0" max="100" value="50" step="1">
            </div>
        </div>

    </div>

    <script>
        const slider = document.getElementById('temp-slider');
        const overlayWarm = document.getElementById('light-overlay');
        const overlayCool = document.getElementById('light-overlay-cool');
        const mainImage = document.getElementById('main-image');
        const display = document.getElementById('current-k-display');

        // ★★★ 核心邏輯：完全依照您提供的參數設定 ★★★
        function updateColor() {
            const val = parseInt(slider.value);
            let k;
            
            // 初始化變數
            let warmOpacity = 0;
            let coolOpacity = 0;
            
            // 圖片基礎濾鏡數值
            let brightness = 100;
            let contrast = 100;
            let saturate = 100;

            if (val <= 50) {
                // --- 4000K - 5000K ---
                const sectionProgress = val / 50;
                k = Math.round(4000 + (sectionProgress * 1000));

                const intensity = 1 - sectionProgress; // 越往左越強

                // ★ 依照您的設定：warmOpacity = intensity * 0.2
                overlayWarm.style.backgroundColor = `rgba(255, 160, 60, ${intensity * 0.2})`;
                overlayCool.style.backgroundColor = `rgba(0, 0, 0, 0)`;

                // ★ 依照您的設定：brightness = 100 + (intensity * 5)
                brightness = 100 + (intensity * 5); 

            } else {
                // --- 5000K - 5700K ---
                const sectionProgress = (val - 50) / 50;
                k = Math.round(5000 + (sectionProgress * 700));

                // ★ 依照您的設定
                overlayWarm.style.backgroundColor = `rgba(0, 0, 0, 0)`;
                // ★ 依照您的設定：coolOpacity = sectionProgress * 0.15
                overlayCool.style.backgroundColor = `rgba(100, 180, 255, ${sectionProgress * 0.15})`;

                // ★ 依照您的設定：contrast + 8, saturate + 10
                contrast = 100 + (sectionProgress * 8);
                saturate = 100 + (sectionProgress * 10);
            }

            display.innerText = `${k}K`;
            
            // 應用濾鏡
            mainImage.style.filter = `brightness(${brightness}%) contrast(${contrast}%) saturate(${saturate}%)`;
        }

        // 點擊標籤快速跳轉
        function setTemp(targetK) {
            if (targetK === 4000) slider.value = 0;
            else if (targetK === 5000) slider.value = 50;
            else if (targetK === 5700) slider.value = 100;
            updateColor();
        }

        // 初始化
        slider.addEventListener('input', updateColor);
        window.onload = updateColor;

    </script>
</body>
</html>